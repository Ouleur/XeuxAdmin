SELECT date_normale(z.GLDGJ) AS DATE_G, z.GLDCT AS TYPE, x.DRDL01 AS LIBELLE_TYPE_PIECE,
z.GLR2 AS REFERENCE, z.GLDOC AS NUMERO, z.GLICU AS N_LOT, z.GLOBJ AS PCG, y.GMDL01 AS LIBELLE_PCG, Trim(GLMCU) AS CENTRE_COUT,
c.MCDL01 AS LIBELLE_CENTRE_DE_COUT, z.GLSUB AS NATURE_ANALYTIQUE,  y.GMDL01 AS LIBELLE_NATURE, z.GLAA AS MONTANT,
decode(sign(GLAA),-1,'C','D') as SENS, z.GLEXA AS LIBELLE_ECRITURE, z.GLPO AS N_BC, z.GLAN8 AS CODE_TIERS, z.GLVINV AS N_FACTURE,
y.DRDL01 AS DIRECTION, y.GMR022 AS CATEGORIE22, z.GLSBL AS SOUS_LIVRE, z.GLTORG AS OPERATEUR, z.GLUSER AS SAISIE_PAR,
date_normale(z.GLUPMJ) AS DATE_LOT, z.GLPID as GLPID
FROM PRODDTA.F0911 z, PRODDTA.F0901 y, PRODDTA.F0006 c, PRODCTL.F0005 x, PRODCTL.F0005 y
WHERE 
z.GLAID = y.GMAID 
and z.GLMCU = c.MCMCU
AND z.GLDCT = ltrim(x.DRKY)
AND x.DRSY='00' 
AND x.DRRT='DT' 
AND y.DRSY='00' 
AND y.DRRT='02' 
AND c.MCRP02 = ltrim(x.DRKY)



AND z.GLDGJ>=date_julien(TO_DATE('01-12-2020','dd-MM-yyyy'))
AND z.GLDGJ<=date_julien(TO_DATE('31-12-2020','dd-MM-yyyy')) 
AND z.GLCO not in ('00050','00070')
AND z.GLPOST='P' 
AND (z.GLAA<>0 ) 
AND z.GLLT = 'AA' 
AND to_number(z.GLOBJ,999999)>=600000
AND to_number(z.GLOBJ,999999) NOT BETWEEN 607000 
AND 607999
AND to_number(z.GLOBJ,999999) <> 609999